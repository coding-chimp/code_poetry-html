<div class="source_table" id="<%= id(stat) %>">
  <div class="header">
    <h2 class="subhead"><%= stat.name %></h2>
  </div>

  <div class="pure-menu pure-menu-open pure-menu-horizontal">
    <ul>
        <li class="pure-menu-selected"><a class="toggle-smells" href="#">Smell View</a></li>
        <li><a class="toggle-source" href="#">Source View</a></li>
    </ul>
  </div>

  <div class="smell-view">
    <ul>
      <% if stat.smells.empty? %>
        <li>Nothing smelly to report! Hurray!</li>
      <% end %>

      <% stat.smells.each do |smell| %>
        <% if smell.complex_class? %>
          <li>
            <span class="smell">Complex class</span>
            <span class="smell-complexity">(complexity <%= stat.complexity %>)</span>
          </li>
        <% elsif smell.complex_class_definition? %>
          <li>
            <span class="smell">Complex</span> code in
            <span class="smell-name"><%= stat.name %></span> definition outside of methods
            <span class="smell-complexity">(complexity <%= stat.definition_complexity %>)</span>
          </li>
        <% elsif smell.complex_method? %>
          <li>
            <span class="smell">Complex method</span>
            <span class="smell-name"><%= smell.method.pretty_name %></span>
            <span class="smell-complexity">(complexity <%= smell.method.complexity %>)</span>
          </li>
        <% end %>
      <% end %>
    </ul>
  </div>

  <div class="source-view" style="display: none;">
    <pre>
      <p><%= stat.file %></p>
      <ol>
        <% stat.lines.each do |number, line| %>
          <li class="<%= line_status(stat, number) %>" data-linenumber="<%= number %>">
            <code class="ruby"><%= CGI.escapeHTML(line.chomp) %></code>
          </li>
        <% end %>
      </ol>
    </pre>
  </div>
</div>
